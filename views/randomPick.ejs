<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Picks</title>
    <link rel="stylesheet" href="randomPick.css">
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous"> -->
</head>

<body>
    <header>
        <span>Random Picks

            <nav class="desktop-nav">
                <ul class="nav-list">
                    <li><a href="/">Home</a></li>
                    <li><a href="/watchList">WatchList</a></li>
                </ul>
            </nav>

            <nav class="mobile-nav">
                <ul class="nav-list">
                    <li><a id="home" href="/">

                            üè†

                        </a></li>
                    <li><a id="watchlist" href="/watchList">

                            üîñ

                        </a></li>
                </ul>
            </nav>
        </span>
    </header>

    <% function getGenreNameById(id) { let genreName; switch (id) { case 28: genreName="Action" ; break; case 12:
        genreName="Adventure" ; break; case 16: genreName="Animation" ; break; case 35: genreName="Comedy" ; break; case
        80: genreName="Crime" ; break; case 99: genreName="Documentary" ; break; case 18: genreName="Drama" ; break;
        case 10751: genreName="Family" ; break; case 14: genreName="Fantasy" ; break; case 36: genreName="History" ;
        break; case 27: genreName="Horror" ; break; case 10402: genreName="Music" ; break; case 9648:
        genreName="Mystery" ; break; case 10749: genreName="Romance" ; break; case 878: genreName="Science Fiction" ;
        break; case 10770: genreName="TV Movie" ; break; case 53: genreName="Thriller" ; break; case 10752:
        genreName="War" ; break; case 37: genreName="Western" ; break; case 10759: genreName="Action&Adventure" ; break;
        case 10762: genreName="Kids" ; break; case 10763: genreName="News" ; break; case 10764: genreName="Reality" ;
        break; case 10765: genreName="Sci-Fi&Fantasy" ; break; case 10766: genreName="Soap" ; break; case 10767:
        genreName="Talk" ; break; case 10768: genreName="War&Politics" ; break; default: console.log("Invalid GenreID:",
        id); genreName="Unknown" ; break;} return genreName;} %>


        <%for (let index=0; index < Random.length; index++) {%>
            <div class="container">
                <div class="imageHolder" style="background-image: url(<%=image+Random[index].backdrop_path%>);">
                    <div class="content">
                        <p>
                            <%= (Random[index].title || Random[index].name) %>
                        </p>
                        <div class="genreContainer">
                            <% let genres=Random[index].genre_ids %>
                                <% for(let innerIndex=0; innerIndex < genres.length; innerIndex++) {%>
                                    <% let genreId=genres[innerIndex] %>
                                        <span class="genres">
                                            <%= getGenreNameById(genreId) %>
                                        </span>
                                        <% } %>
                        </div>
                    </div>
                </div>
                <div class="outerContent">
                    <span class="ratings">‚≠ê<%= Random[index].vote_average %> / 10</span>
                    <textarea class="descriptions"><%= Random[index].overview %></textarea>
                    <button type="button" data-index="<%= Random[index].id %>" class="btn">Save to Watchlist</button>
                </div>
            </div>
            <%} %>

                <script>
                    const Button = document.querySelectorAll("button");
                    let watchList = [];
                    for (let index = 0; index < Button.length; index++) {
                        Button[index].addEventListener("click", function () {
                            let value = this.getAttribute('data-index');
                            watchList.push(value);

                            fetch("/send", {
                                method: "post",
                                headers: { "content-type": "application/json" },
                                body: JSON.stringify({
                                    selectedIds: watchList
                                })
                            });
                            alert(`Saved to Watchlist!`);
                        });
                    }

                </script>

</body>


</html>
